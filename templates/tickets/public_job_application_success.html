{% extends 'base.html' %}
{% load static %}
{% load project_extras %}

{% block extra_css %}
<style>
.success-header {
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
    color: white;
    padding: 3rem 0;
    margin-bottom: 2rem;
    text-align: center;
}
.success-icon {
    font-size: 4rem;
    margin-bottom: 1rem;
}
.next-steps {
    background-color: #e7f3ff;
    border-left: 4px solid #007bff;
    padding: 1.5rem;
    margin: 1.5rem 0;
}
.timeline {
    position: relative;
    padding-left: 3rem;
}
.timeline-item {
    position: relative;
    padding-bottom: 2rem;
}
.timeline-item:before {
    content: '';
    position: absolute;
    left: -1.5rem;
    top: 0.5rem;
    bottom: -2rem;
    width: 2px;
    background-color: #dee2e6;
}
.timeline-item:last-child:before {
    display: none;
}
.timeline-marker {
    position: absolute;
    left: -2rem;
    top: 0.5rem;
    width: 1rem;
    height: 1rem;
    border-radius: 50%;
    border: 2px solid #fff;
    box-shadow: 0 0 0 2px #dee2e6;
}
.timeline-content {
    padding-left: 1rem;
}
</style>
{% endblock %}

{% block title %}Aplicaci√≥n Enviada - {{ employee.position }}{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Cabecera de √©xito -->
    <div class="success-header rounded">
        <div class="container">
            <div class="success-icon">
                <i class="bi bi-check-circle"></i>
            </div>
            <h1>¬°Aplicaci√≥n Enviada Exitosamente!</h1>
            <p class="lead">Tu aplicaci√≥n para <strong>{{ employee.position }}</strong> ha sido recibida</p>
        </div>
    </div>

    <div class="row">
        <!-- Informaci√≥n de la aplicaci√≥n -->
        <div class="col-lg-8">
            <div class="card mb-4">
                <div class="card-header">
                    <h5><i class="bi bi-info-circle"></i> Resumen de tu Aplicaci√≥n</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <strong>Nombre:</strong><br>
                                {{ employee.get_full_name }}
                            </div>
                            <div class="mb-3">
                                <strong>Email:</strong><br>
                                {{ employee.email }}
                            </div>
                            {% if employee.phone %}
                            <div class="mb-3">
                                <strong>Tel√©fono:</strong><br>
                                {{ employee.phone }}
                            </div>
                            {% endif %}
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <strong>Puesto:</strong><br>
                                {{ employee.position }}
                            </div>
                            <div class="mb-3">
                                <strong>Empresa:</strong><br>
                                {{ employee.company.name }}
                            </div>
                            <div class="mb-3">
                                <strong>Fecha de aplicaci√≥n:</strong><br>
                                {{ employee.created_at|date:"d/m/Y H:i" }}
                            </div>
                        </div>
                    </div>
                    
                    {% if employee.salary_euros %}
                    <div class="alert alert-info">
                        <i class="bi bi-currency-euro"></i>
                        <strong>Salario propuesto:</strong> ‚Ç¨{{ employee.salary_euros|floatformat:0 }} anuales
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Pr√≥ximos pasos -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5><i class="bi bi-list-check"></i> ¬øQu√© sigue ahora?</h5>
                </div>
                <div class="card-body">
                    <div class="next-steps">
                        <h6><i class="bi bi-lightbulb"></i> Tu aplicaci√≥n est√° en proceso</h6>
                        <p class="mb-0">
                            Hemos recibido tu aplicaci√≥n y comenzar√° a ser procesada autom√°ticamente. 
                            Te mantendremos informado sobre el estado de tu candidatura.
                        </p>
                    </div>

                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="timeline-marker bg-success"></div>
                            <div class="timeline-content">
                                <h6>‚úÖ Aplicaci√≥n Recibida</h6>
                                <p class="text-muted mb-0">{{ employee.created_at|date:"d/m/Y H:i" }}</p>
                                <small>Tu aplicaci√≥n ha sido registrada exitosamente</small>
                            </div>
                        </div>
                        
                        {% if employee.ai_analysis %}
                        <div class="timeline-item">
                            <div class="timeline-marker bg-info"></div>
                            <div class="timeline-content">
                                <h6>ü§ñ An√°lisis Autom√°tico Completado</h6>
                                <p class="text-muted mb-0">Procesado autom√°ticamente</p>
                                <small>Tu perfil ha sido analizado por nuestro sistema de IA</small>
                                {% if employee.ai_score %}
                                <div class="mt-1">
                                    <span class="badge 
                                        {% if employee.ai_score >= 8 %}bg-success
                                        {% elif employee.ai_score >= 6 %}bg-warning
                                        {% else %}bg-danger
                                        {% endif %}">
                                        Puntuaci√≥n: {{ employee.ai_score }}/10
                                    </span>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}
                        
                        <div class="timeline-item">
                            <div class="timeline-marker bg-warning"></div>
                            <div class="timeline-content">
                                <h6>‚è≥ Revisi√≥n por RR.HH.</h6>
                                <p class="text-muted mb-0">En proceso</p>
                                <small>Nuestro equipo de recursos humanos revisar√° tu candidatura</small>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-marker bg-secondary"></div>
                            <div class="timeline-content">
                                <h6>üìû Contacto Directo</h6>
                                <p class="text-muted mb-0">Pendiente</p>
                                <small>Si tu perfil encaja, nos pondremos en contacto contigo</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Informaci√≥n adicional -->
            <div class="card">
                <div class="card-header">
                    <h5><i class="bi bi-question-circle"></i> Informaci√≥n Importante</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6><i class="bi bi-clock"></i> Tiempo de respuesta</h6>
                            <p class="small text-muted">
                                Normalmente respondemos en un plazo de 3-5 d√≠as h√°biles. 
                                Si tu perfil es seleccionado, recibir√°s un email con los siguientes pasos.
                            </p>
                        </div>
                        <div class="col-md-6">
                            <h6><i class="bi bi-shield-check"></i> Privacidad</h6>
                            <p class="small text-muted">
                                Tus datos est√°n protegidos y ser√°n utilizados √∫nicamente para 
                                este proceso de selecci√≥n conforme a la normativa vigente.
                            </p>
                        </div>
                    </div>
                    
                    <div class="alert alert-warning">
                        <i class="bi bi-exclamation-triangle"></i>
                        <strong>Importante:</strong> 
                        Guarda el enlace de esta p√°gina como referencia. 
                        Tambi√©n te hemos enviado un email de confirmaci√≥n a <strong>{{ employee.email }}</strong>.
                    </div>
                </div>
            </div>
        </div>

        <!-- Informaci√≥n lateral -->
        <div class="col-lg-4">
            <!-- Datos de contacto -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5><i class="bi bi-envelope"></i> Contacto</h5>
                </div>
                <div class="card-body">
                    <p>Si tienes alguna pregunta sobre tu aplicaci√≥n:</p>
                    
                    {% if token.company.email %}
                    <div class="mb-2">
                        <i class="bi bi-envelope"></i>
                        <a href="mailto:{{ token.company.email }}?subject=Consulta sobre aplicaci√≥n - {{ employee.position }}">
                            {{ token.company.email }}
                        </a>
                    </div>
                    {% endif %}
                    
                    {% if token.company.phone %}
                    <div class="mb-2">
                        <i class="bi bi-telephone"></i>
                        <a href="tel:{{ token.company.phone }}">{{ token.company.phone }}</a>
                    </div>
                    {% endif %}
                    
                    {% if token.company.website %}
                    <div class="mb-2">
                        <i class="bi bi-globe"></i>
                        <a href="{{ token.company.website }}" target="_blank">{{ token.company.website }}</a>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Consejos -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5><i class="bi bi-lightbulb"></i> Consejos</h5>
                </div>
                <div class="card-body">
                    <div class="small">
                        <h6>Mientras esperas:</h6>
                        <ul class="text-muted">
                            <li>Mant√©n tu email accesible</li>
                            <li>Revisa tu carpeta de spam</li>
                            <li>Prep√°rate para una posible entrevista</li>
                            <li>Investiga m√°s sobre la empresa</li>
                            <li>Ten tu documentaci√≥n preparada</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Compartir -->
            <div class="card">
                <div class="card-header">
                    <h5><i class="bi bi-share"></i> Compartir</h5>
                </div>
                <div class="card-body text-center">
                    <p class="small text-muted">¬øConoces a alguien interesado en este puesto?</p>
                    <a href="{% absolute_url token.get_public_url %}" class="btn btn-outline-primary btn-sm">
                        <i class="bi bi-link-45deg"></i> Compartir Enlace
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}