{% extends 'base.html' %}
{% load static %}

{% block title %}Eliminar Rastreo - {{ tracker.target }}{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'dashboard' %}">Dashboard</a></li>
            <li class="breadcrumb-item"><a href="{% url 'website_tracker_list' %}">Rastreador Web</a></li>
            <li class="breadcrumb-item"><a href="{% url 'website_tracker_detail' tracker.pk %}">{{ tracker.target }}</a></li>
            <li class="breadcrumb-item active" aria-current="page">Eliminar</li>
        </ol>
    </nav>

    <!-- Título -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h2">
            <i class="bi bi-trash text-danger"></i>
            Eliminar Rastreo
        </h1>
    </div>

    <!-- Alerta de advertencia -->
    <div class="alert alert-danger" role="alert">
        <h4 class="alert-heading">
            <i class="bi bi-exclamation-triangle-fill"></i>
            ¿Estás seguro?
        </h4>
        <p class="mb-0">
            Esta acción no se puede deshacer. Se eliminará permanentemente el rastreo de <strong>{{ tracker.target }}</strong> 
            y toda la información asociada.
        </p>
    </div>

    <!-- Card con información del rastreo -->
    <div class="card shadow-sm mb-4">
        <div class="card-header bg-light">
            <h5 class="mb-0">
                <i class="bi bi-info-circle"></i>
                Información del Rastreo
            </h5>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Objetivo:</strong> {{ tracker.target }}</p>
                    <p><strong>Estado:</strong> 
                        {% if tracker.is_active %}
                            <span class="badge bg-success">En línea</span>
                        {% elif tracker.error_message %}
                            <span class="badge bg-danger">Error</span>
                        {% else %}
                            <span class="badge bg-secondary">Offline</span>
                        {% endif %}
                    </p>
                    <p><strong>Dirección IP:</strong> {{ tracker.ip_address|default:"N/A" }}</p>
                </div>
                <div class="col-md-6">
                    <p><strong>Código HTTP:</strong> {{ tracker.http_status_code|default:"N/A" }}</p>
                    <p><strong>Rastreado por:</strong> {{ tracker.user.get_full_name|default:tracker.user.username }}</p>
                    <p><strong>Fecha de creación:</strong> {{ tracker.created_at|date:"d/m/Y H:i" }}</p>
                </div>
            </div>

            {% if tracker.error_message %}
                <hr>
                <div class="alert alert-warning mb-0">
                    <strong>Último error:</strong><br>
                    {{ tracker.error_message }}
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Botones de acción -->
    <div class="d-flex gap-2">
        <form method="POST" class="d-inline">
            {% csrf_token %}
            <button type="submit" class="btn btn-danger">
                <i class="bi bi-trash"></i>
                Sí, eliminar definitivamente
            </button>
        </form>
        <a href="{% url 'website_tracker_detail' tracker.pk %}" class="btn btn-secondary">
            <i class="bi bi-x-circle"></i>
            Cancelar
        </a>
        <a href="{% url 'website_tracker_list' %}" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left"></i>
            Volver a la lista
        </a>
    </div>
</div>

<style>
    .alert-heading {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 0.5rem;
    }

    .card {
        border: 1px solid #dee2e6;
    }

    .card-header {
        border-bottom: 2px solid #dee2e6;
    }

    .btn {
        transition: all 0.3s ease;
    }

    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 0.25rem 0.5rem rgba(0,0,0,0.15);
    }

    .gap-2 {
        gap: 0.5rem !important;
    }
</style>
{% endblock %}
