{% extends 'public_base.html' %}
{% load static %}

{% block title %}{{ page_title }}{% endblock %}

{% block extra_head %}
<style>
    body {
        background: linear-gradient(135deg, {{ generator.background_color }}15, {{ generator.background_color }}05);
        min-height: 100vh;
    }
    .contact-form-card {
        background: white;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        border-top: 4px solid {{ generator.background_color }};
    }
    .btn-custom {
        background-color: {{ generator.background_color }};
        border-color: {{ generator.background_color }};
        color: white;
        padding: 12px 30px;
        font-weight: 500;
        border-radius: 8px;
        transition: all 0.3s ease;
    }
    .btn-custom:hover {
        background-color: {{ generator.background_color }}dd;
        border-color: {{ generator.background_color }}dd;
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 5px 15px {{ generator.background_color }}40;
    }
    .form-control {
        border-radius: 8px;
        border: 2px solid #e9ecef;
        padding: 12px 15px;
        transition: all 0.3s ease;
    }
    .form-control:focus {
        border-color: {{ generator.background_color }};
        box-shadow: 0 0 0 0.2rem {{ generator.background_color }}25;
    }
    .company-logo {
        max-height: 60px;
        width: auto;
    }
    .success-animation {
        animation: fadeInUp 0.5s ease-out;
    }
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    .required-field::after {
        content: " *";
        color: #dc3545;
    }
</style>
{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-6 col-md-8">
            {% if success %}
                <!-- Mensaje de Éxito -->
                <div class="contact-form-card p-5 text-center success-animation">
                    <div class="mb-4">
                        <i class="bi bi-check-circle-fill text-success" style="font-size: 4rem;"></i>
                    </div>
                    <h2 class="mb-3 text-success">¡Perfecto!</h2>
                    <p class="lead mb-4">{{ success_message }}</p>
                    <div class="bg-light p-3 rounded">
                        <small class="text-muted">
                            <i class="bi bi-building me-1"></i>
                            {{ generator.company.name }}
                        </small>
                    </div>
                </div>
            {% else %}
                <!-- Formulario de Contacto -->
                <div class="contact-form-card p-5">
                    <!-- Header -->
                    <div class="text-center mb-4">
                        <h1 class="h3 mb-3" style="color: {{ generator.background_color }};">
                            {{ generator.title }}
                        </h1>
                        <p class="text-muted mb-0">{{ generator.welcome_message }}</p>
                    </div>

                    <!-- Company Info -->
                    <div class="text-center mb-4">
                        <div class="bg-light p-3 rounded d-inline-block">
                            <i class="bi bi-building me-1" style="color: {{ generator.background_color }};"></i>
                            <strong>{{ generator.company.name }}</strong>
                        </div>
                    </div>

                    <!-- Formulario -->
                    <form method="post" id="contactForm">
                        {% csrf_token %}
                        
                        <div class="row">
                            <!-- Nombre (siempre requerido) -->
                            <div class="col-md-12">
                                <div class="mb-3">
                                    <label for="{{ form.name.id_for_label }}" class="form-label fw-bold required-field">
                                        <i class="bi bi-person me-1"></i>
                                        Nombre Completo
                                    </label>
                                    {{ form.name }}
                                    {% if form.name.errors %}
                                        <div class="text-danger small mt-1">{{ form.name.errors.0 }}</div>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- Email (siempre requerido) -->
                            <div class="col-md-12">
                                <div class="mb-3">
                                    <label for="{{ form.email.id_for_label }}" class="form-label fw-bold required-field">
                                        <i class="bi bi-envelope me-1"></i>
                                        Correo Electrónico
                                    </label>
                                    {{ form.email }}
                                    {% if form.email.errors %}
                                        <div class="text-danger small mt-1">{{ form.email.errors.0 }}</div>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- Teléfono (condicional) -->
                            {% if form.phone %}
                                <div class="col-md-12">
                                    <div class="mb-3">
                                        <label for="{{ form.phone.id_for_label }}" class="form-label fw-bold">
                                            <i class="bi bi-telephone me-1"></i>
                                            Teléfono
                                        </label>
                                        {{ form.phone }}
                                        {% if form.phone.errors %}
                                            <div class="text-danger small mt-1">{{ form.phone.errors.0 }}</div>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endif %}

                            <!-- Empresa (condicional) -->
                            {% if form.company %}
                                <div class="col-md-12">
                                    <div class="mb-3">
                                        <label for="{{ form.company.id_for_label }}" class="form-label fw-bold">
                                            <i class="bi bi-building me-1"></i>
                                            Empresa
                                        </label>
                                        {{ form.company }}
                                        {% if form.company.errors %}
                                            <div class="text-danger small mt-1">{{ form.company.errors.0 }}</div>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endif %}

                            <!-- Cargo/Posición (condicional) -->
                            {% if form.position %}
                                <div class="col-md-12">
                                    <div class="mb-3">
                                        <label for="{{ form.position.id_for_label }}" class="form-label fw-bold">
                                            <i class="bi bi-person-badge me-1"></i>
                                            Cargo o Posición
                                        </label>
                                        {{ form.position }}
                                        {% if form.position.errors %}
                                            <div class="text-danger small mt-1">{{ form.position.errors.0 }}</div>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endif %}

                            <!-- Notas (condicional) -->
                            {% if form.notes %}
                                <div class="col-md-12">
                                    <div class="mb-3">
                                        <label for="{{ form.notes.id_for_label }}" class="form-label fw-bold">
                                            <i class="bi bi-chat-text me-1"></i>
                                            Comentarios Adicionales
                                        </label>
                                        {{ form.notes }}
                                        {% if form.notes.errors %}
                                            <div class="text-danger small mt-1">{{ form.notes.errors.0 }}</div>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endif %}
                        </div>

                        <!-- Botón de Envío -->
                        <div class="d-grid">
                            <button type="submit" class="btn btn-custom bg-primary text-white btn-lg" id="submitBtn">
                                <i class="bi bi-send me-2"></i>
                                Enviar Información
                            </button>
                        </div>

                        <!-- Información de Privacidad -->
                        <div class="text-center mt-4">
                            <small class="text-muted">
                                <i class="bi bi-shield-check me-1"></i>
                                Tu información será tratada de forma confidencial y no será compartida con terceros.
                            </small>
                        </div>
                    </form>
                </div>
            {% endif %}

            <!-- Footer -->
            <div class="text-center mt-4">
                <small class="text-muted">
                    Powered by <strong>{{ generator.company.name }}</strong>
                </small>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('contactForm');
    const submitBtn = document.getElementById('submitBtn');
    
    if (form && submitBtn) {
        form.addEventListener('submit', function() {
            submitBtn.innerHTML = '<i class="spinner-border spinner-border-sm me-2"></i>Enviando...';
            submitBtn.disabled = true;
        });
    }

    // Animación de entrada
    const card = document.querySelector('.contact-form-card');
    if (card) {
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';
        setTimeout(() => {
            card.style.transition = 'all 0.5s ease-out';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, 100);
    }
});
</script>
{% endblock %}